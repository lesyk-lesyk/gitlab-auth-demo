<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Demo Window Opener: Index</title>
  </head>
  <body>
    <p>GitLab Authorization Code Grant (window opener):</p>
    <button onclick="authrorizeGitLab()">Authorize GitLab</button>
  </body>
  <script>
    function authrorizeGitLab() {
      // 1. Construct params for redirect
      const authParams = {
        client_id:
          "2ca4cc0c4f1707a97116e19268f01719d525d70e156849dfba89ae168dd59c68",
        redirect_uri: "http://127.0.0.1:8080/redirect-here.html",
        response_type: "code",
        state: "TMP_STR",
        scope: "api",
      };

      // 2. Make redirect URI
      const queryParams = new URLSearchParams(authParams).toString();
      const redirectURI = "https://gitlab.com/oauth/authorize?" + queryParams;

      // 3. Add object to window
      window.SUPER_TOOLS = {
        xxx: "aaa",
        logCode: function (code) {
          console.log("code:", code);
        },
      };

      // 4. Redirect to GitLab in the separate tab
      window.open(redirectURI);
    }
  </script>
</html>
